---
title: 2.3.1 Introducció a les funcions
parent: 2.3 Funcions i Events
layout: default
has_children: true
nav_order: 1
---

# Introducció a les funcions

En Blocs, les `funcions` servien com una eina poderosa per a fer que els jocs complexos foren més fàcils de llegir, així com per a reduir la redundància dins dels jocs.

## Concepte: Funcions en Python

---

title: 2.3.1 Introducció a les funcions
parent: 2.3 Funcions i Events
layout: default
has_children: true
nav_order: 1

---

# Introducció a les funcions

En Blocs, les `funcions` servien com una eina poderosa per a fer que els jocs complexos foren més fàcils de llegir, així com per a reduir la redundància dins dels jocs.

## Concepte: Funcions en Python

Les `funcions` en Python són un poc més complexes per a començar que les `funcions` en Blocs. No obstant això, les funcions en Python s'utilitzen molt més comunament que en blocs, així que no tardaràs molt a acostumar-te a la nova sintaxi.

```python
def nom_funcio():
    # contingut de la funció
nom_funcio()
```

En aquest fragment de codi, fixa't en els següents elements de la funció:

- `def`: indica l'inici d'una nova funció
- `name`: el nom de la funció que estàs creant
- Codi indentat: les instruccions indentades (tabulades) són el contingut de la funció (equivalent als blocs dins de la funció); en aquest cas, la funció no fa res, ja que només hi ha un comentari dins d'ella.
- `name()`: crida la funció `name`, executant el codi que se li assigna.

## Exemple #1: Di Hola

![Animació de la creació de la primera funció](https://cdn.makecode.com/blob/5086ee890b53d090009935e2c8b33b7fc8569ba3/static/courses/csintro3/functions/creating-first-function.gif)

1. Revisa el codi següent:

   ```python
   def digues_hola():
       game.splash("hola")
   ```

2. Converteix el codi a Blocs
3. Identifica quins blocs provenen de quines parts del codi

## Tasca #1: Fes un Registre

1. Crea una funció anomenada `crea_registre`
2. En la funció, fes un `game.splash` amb la frase "CREANT REGISTRES"
3. Després del `game.splash`, utilitza `print` per a registrar la frase "Estic aquí!" a la consola
4. Crida la funció dues vegades.

## Concepte: Àmbit de Variables

Una diferència important en les funcions entre Blocs i Python és l'`àmbit de variables`. Això es refereix a on en el codi es pot accedir a una variable.

Això es pot veure en una petita manera amb bucles: per exemple, el següent fragment fallarà en executar-se, perquè `i` només és accessible dins del bucle en què es defineix - aquest és l'`àmbit` de la variable.

```python
for i in range(5):
    print("Hola!")
print("Acabe de registrar " + str(i) + " vegades!")  # error! No es pot trobar la variable `i`!
```

Això pot semblar un problema al principi, però en realitat és un comportament útil a mesura que la quantitat de codi en un projecte creix més enllà de poques línies.

Per exemple, si declarar la variable en el bucle la fes disponible en tot el programa, el següent codi fallaria perquè estaria intentant declarar `i` dues vegades.

```python
for i in range(5):
    print("Hola!")
for i in range(5):
    print("Adéu!")
```

Això podria convertir-se ràpidament en un embolic a mesura que el programa que s'està desenvolupant arriba a tenir dotzenes (o centenars) de línies.

De manera similar, les variables declarades dins d'una funció o bucle només són accessibles dins de la funció.

```python
a = 0
def example():
    b = 1
    a = 2  # es pot utilitzar `a` aquí, ja que es declara fora de la funció
# no es pot utilitzar `b` aquí, ja que es declara dins de la funció
```

En aquest fragment, `b` només és accessible dins de `example` on es declara, mentre que `a` és accessible tant dins com fora de la funció.

## Exemple #2: El Meu Petit Amic

1. Revisa el codi següent
2. Identifica quines de les quatre crides comentades a `game.splash` són vàlides
3. Prova cada `game.splash` descomentant-les (eliminant el `#` abans de la crida al mètode)

```python
little = None
my_word = None

def mystery():
    friend = "hola"
    global little
    little = 5
    global my_word
    my_word = "I'm here!"

    # game.splash(friend)
    # game.splash("" + str(little))

# game.splash(my_word)
# game.splash(friend)
```

## Tasca de l'Estudiant #2: Nombres Diferents

1. Revisa el codi següent
2. Llegeix el comentari al costat de cada `game.splash`
3. Fes que el joc coincidisca amb la sortida esperada canviant on es declaren `count` i `log`

```python
count = 0
log = ""

def splash_number_one():
    global count
    count += 1
    global log
    log += "el nombre és " + str(count)
    game.splash(log)  # Ha de mostrar "el nombre és 1"

def splash_number_two():
    global count
    count += 2
    global log
    log += "el nombre és " + str(count)
    game.splash(log)  # Ha de mostrar "el nombre és 2"

splash_number_one()
splash_number_two()
splash_number_one()
```

## Què hem aprés?

1. Què fan les claus `{}` quan es declara una nova funció?
2. Com es maneja el codi com la tasca #2 en Blocs? Copia la teua solució per a la tasca #2 en un nou projecte i converteix-la a blocs - què es veu diferent?

## Estudi de Cas

### Inicialització i Inicialitzar

Afig una funció anomenada `initialize` al namespace `status`, que estableix els valors inicials per a `life` a 4 i `score` a 0. Després d'escriure la funció, crida la funció en el namespace `status`, i elimina els `info.setLife` i `info.setScore` que actualment estan en el namespace.

### Configuració d'Sprite

Afig una funció anomenada `initialize` al namespace `ship`, que configura el sprite del vaixell al començament del joc. Aquesta funció hauria de configurar els valors inicials per a

### Solució

```python
# Configura l'estat del joc
def initialize_status():
    info.set_life(4)
    info.set_score(0)

initialize_status()

# Crea i controla el vaixell del jugador
def initialize_ship():
    global player
    player = sprites.create(spritesheet.player, SpriteKind.player)
    controller.move_sprite(player, 80, 30)
    player.x = screen.width / 2
    player.y = screen.height - 20

initialize_ship()

# Quan el jugador prem A, dispara un làser des de la nau espacial
def on_a_pressed():
    sprites.create_projectile(spritesheet.laser, 0, -40, SpriteKind.laser, player)

controller.A.on_event(ControllerButtonEvent.pressed, on_a_pressed)
```

```

```

Les `funcions` en Python són un poc més complexes per a començar que les `funcions` en Blocs. No obstant això, les funcions en Python s'utilitzen molt més comunament que en blocs, així que no tardaràs molt a acostumar-te a la nova sintaxi.

```python
def nom_funcio():
    # contingut de la funció
nom_funcio()
```

En aquest fragment de codi, fixa't en els següents elements de la funció:

- `def`: indica l'inici d'una nova funció
- `name`: el nom de la funció que estàs creant
- Codi indentat: les instruccions indentades (tabulades) són el contingut de la funció (equivalent als blocs dins de la funció); en aquest cas, la funció no fa res, ja que només hi ha un comentari dins d'ella.
- `name()`: crida la funció `name`, executant el codi que se li assigna.

## Exemple #1: Di Hola

![Animació de la creació de la primera funció](https://cdn.makecode.com/blob/5086ee890b53d090009935e2c8b33b7fc8569ba3/static/courses/csintro3/functions/creating-first-function.gif)

1. Revisa el codi següent:

   ```python
   def digues_hola():
       game.splash("hola")
   ```

2. Converteix el codi a Blocs
3. Identifica quins blocs provenen de quines parts del codi

## Tasca #1: Fes un Registre

1. Crea una funció anomenada `crea_registre`
2. En la funció, fes un `game.splash` amb la frase "CREANT REGISTRES"
3. Després del `game.splash`, utilitza `print` per a registrar la frase "Estic aquí!" a la consola
4. Crida la funció dues vegades.

## Concepte: Funcions com a bucles

En blocs podiem utilitzar el bloc `al actualitzar` per a repetir un bloc de codi moltes vegades. En Python, podem fer el mateix definint una funció i utilitzant després `game.on_update_interval` per a cridar la funció a intervals regulars. Haurem de definir la funció abans de cridar-la i especificar l'interval en mil·lisegons.

```python
def imprimeix_hola_cada_segon():
    print("Hola!")

game.on_update_interval(1000, imprimeix_hola_cada_segon)
```

En aquest exemple, `imprimeix_hola_cada_segon` s'executarà cada segon, mostrant "Hola!" a la consola.

## Concepte: Funcions com a esdeveniments

En Python, podem utilitzar funcions per a respondre a esdeveniments. Això és similar a com ho fèiem en Blocs amb els blocs `quan A premut` i `quan A alliberat`.

```python
def quan_a_premut():
    print("A premut!")

controller.A.on_event(ControllerButtonEvent.pressed, quan_a_premut)
```

En aquest exemple, `quan_a_premut` s'executarà cada vegada que el botó A es premi.

Un altre event important és `on_overlap`. Aquest esdeveniment es produeix quan dos sprites es solapen.

Per a utilitzar aquest esdeveniment, primer hem de definir una funció que es cridarà quan es produeixi l'esdeveniment. A continuació, cridem `sprites.on_overlap` amb els dos SpriteKinds (tipus de sprite) que volem que es solapen i la funció que volem que s'executi.

```python
def quan_es_solapen(sprite, altre_sprite):
    print("Els sprites s'han solapat!")

sprites.on_overlap(SpriteKind.player, SpriteKind.enemy, quan_es_solapen)
```

En aquest exemple, `quan_es_solapen` s'executarà cada vegada que un sprite de tipus `player` es solapi amb un sprite de tipus `enemy`.

## Tasca #2: Crea un petit joc

1. Crea un joc senzill amb un jugador que es pugui moure a l'esquerra i a la dreta amb les tecles de fletxa.
2. Fes que cada 500ms aparegui un enemic (projectil) a la part superior de la pantalla i es mogui cap avall.
3. Fes que el joc acabi quan el jugador es solapi amb un enemic.
